clear all;
close all;
clc
nn=1;
W=20;
%r=0.2725;
aird=1.168;
A=0.214;
% b=2;
% c=0.03175;
s=0.045;
%kk=0.17; 
k=0.11;
%del=0.012;
del=0.011;
%C_t=5.013e-5/(aird*A*(r^2));
%C_t=7.173e-5/(aird*A*(r^2));
C_t=1.195e-3;
SFP=0.009;
SFP2=0.377;
%SFP2=0.19;
%SFP_2=0.377;
v0=6.325;
n=4;
pb=W^(3/2)*C_t^(-3/2)*del*s/(8*sqrt(n*aird*A));
pin=(1+k)*W^(3/2)/sqrt(2*n*aird*A);
p1=3*del*s*sqrt(W*n*aird*A/C_t)/8;
p2=n*SFP*aird/2;
p3=2*v0^2;
p4=n*A*aird/4;
p5=p4^2;
p6=2*W/(n*aird*A);
p7=SFP2^2/A^2;
p8=n*SFP2*aird;
p9=n*aird*SFP2/4;
eup=[57274.5,48388.7,48300.9,48217.1,48207.6,48205.1,48207,48205,48230.5,48221.3,48192,48201.4,48214.8,48213.9,48177.6,48224,48216,48206.5,48226.7];
tup=[166.667,116.8461,114.0891,114.7533,114.9403,114.9328,115.0163,114.8443,114.712,114.7457,115.1695,115.0841,114.826,114.8187,115.22,114.7172,114.9339,114.8629,114.7135];
dup=[5024.93,2550.26,1838.6,1988.23,1991.9,1987.92,1989.4,1990,1987.72,1986.31,1990.56,1989.44,1987.75,1991,1995.24,1990.53,1992.14,1991.35,1989.76];
ddown=[5024.93,2550.26,1739.8,1346.3,1118.04,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76,1747.76];
edown=[40362.3,17019.8,16321.2,16583.8,17041.2,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1,16321.1];
tdown=[166.6667,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100];
r1=[1/10,2/10,3/10,4/10,5/10,6/10,7/10,8/10,9/10,1,10/9,10/8,10/7,10/6,10/5,10/4,10/3,10/2,10/1];
for i=1:length(r1),
rd(i)=500*sqrt((1/r1(i)^2)+1);
end
for j=1:length(eup),
vup(j)=500/tup(j);
vdown(j)=500/tdown(j);
vhor1(j)=vup(j)/r1(j);
vhor2(j)=vdown(j)/r1(j);
vhu(j)=(pin+pb+(p1*vhor1(j)^2)+(pin*(sqrt(sqrt(1+(vhor1(j)^4/(4*v0^4)))-(vhor1(j)^2/(2*v0^2)))-1))+(p2*vhor1(j)^2)+(W*vup(j)/2)+(n*SFP2*aird*(vup(j))^3/4)+(((W/2)+(n*SFP2*aird*(vup(j))^2/4))*sqrt((2*W/(n*aird*A))+((1+(SFP2/A))*(vup(j))^2))))*(500/vup(j));
vhd(j)=(pin+pb+(p1*vhor2(j)^2)+(pin*(sqrt(sqrt(1+(vhor2(j)^4/(4*v0^4)))-(vhor2(j)^2/(2*v0^2)))-1))+(p2*vhor2(j)^2)+(W*vdown(j)/2)-(n*SFP2*aird*(vdown(j))^3/4)+(((W/2)-(n*SFP2*aird*(vdown(j))^2/4))*sqrt((2*W/(n*aird*A))+((1-(SFP2/A))*(vdown(j))^2))))*(500/vdown(j));
end
for i=1:length(eup),
fup(i)=(abs(eup(i)-vhu(i))/vhu(i))*100;
fdown(i)=(abs(edown(i)-vhd(i))/vhd(i))*100;
end
for i=1:19,
fru(i)=abs((eup(i)/dup(i))-(vhu(i)/rd(i)));
frd(i)=abs((edown(i)/ddown(i))-(vhd(i)/rd(i)));
end
frd(1:5)=0;
fru(1)=0;
figure;
x1=1:1:19;
plot(x1,fup,'-^m');
hold on
plot(x1,fdown,'-.b');
grid on
box on
%x2=[30,60,90,120,150,180,210,240,270,300];
legend('Ascent status','Descent status');
set(gca, 'xTick', [1:1:19]);
set(gca,'XTickLabel',{'1/10','2/10','3/10','4/10','5/10','6/10','7/10','8/10','9/10','1','10/9','10/8','10/7','10/6','10/5','10/4','10/3','10/2','10/1'})
xlabel('Ratio k_{IF}')
ylabel('Energy consumption optimization percentage (%)')
%set(gca,'xtick', [1:1:8],'XTickLabel',['1/10','2/10','3/10','4/10','5/10','6/10','7/10','8/10','9/10','1','10/9','10/8','10/7','10/6','10/5','10/4','10/3','10/2','10/1']);
figure;
x1=1:1:19;
plot(x1,fru,'-^m');
hold on
plot(x1,frd,'-.b');
grid on;
box on;
legend('Ascent status','Descent status');
set(gca, 'xTick', [1:1:19]);
set(gca,'XTickLabel',{'1/10','2/10','3/10','4/10','5/10','6/10','7/10','8/10','9/10','1','10/9','10/8','10/7','10/6','10/5','10/4','10/3','10/2','10/1'})
xlabel('Ratio k_{IF}')
ylabel('Optimized energy / distance (J/m)')